<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Domain (whatwhat.Whatwhat.Domain)</title><link rel="stylesheet" href="../../../_odoc_support/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.2.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../_odoc_support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">whatwhat</a> &#x00BB; <a href="../index.html">Whatwhat</a> &#x00BB; Domain</nav><header class="odoc-preamble"><h1>Module <code><span>Whatwhat.Domain</span></code></h1><p>Domain model</p><p>This module declares the types which represent the domain model, independent of how GitHub and Forecast (or other systems) store the information.</p><p>It also defines a set of utilities for working with some of those types (primarily the ones involving periods of time).</p></header><nav class="odoc-toc"><ul><li><a href="#measures-and-units">Measures and units</a></li><li><a href="#periods-of-time">Periods of time</a></li><li><a href="#entities-relevant-to-scheduling-and-planning">Entities relevant to scheduling and planning</a></li></ul></nav><div class="odoc-content"><div class="odoc-spec"><div class="spec module anchored" id="module-IntMap"><a href="#module-IntMap" class="anchor"></a><code><span><span class="keyword">module</span> <a href="IntMap/index.html">IntMap</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-StringMap"><a href="#module-StringMap" class="anchor"></a><code><span><span class="keyword">module</span> <a href="StringMap/index.html">StringMap</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-DateMap"><a href="#module-DateMap" class="anchor"></a><code><span><span class="keyword">module</span> <a href="DateMap/index.html">DateMap</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><h2 id="measures-and-units"><a href="#measures-and-units" class="anchor"></a>Measures and units</h2><div class="odoc-spec"><div class="spec module anchored" id="module-FTE"><a href="#module-FTE" class="anchor"></a><code><span><span class="keyword">module</span> <a href="FTE/index.html">FTE</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><h2 id="periods-of-time"><a href="#periods-of-time" class="anchor"></a>Periods of time</h2><p>We deal in days as the atomic unit of allocations, although, in practice, we try to ensure that allocations are aligned to weeks (starting on Monday and ending on Sunday) and, if possible, to months (starting on the Monday of the first week in a month).</p><p>In order to assign weeks to months we use the following rule: A week belongs to a month if, and only if, the Thursday of the week falls in the month. (We use this rule to be consistent with the ISO 8601 rule for when a week belongs to a year.)</p><p>The total resource available for a project tends to be specified in months of FTE. However, we occasionally need to assign people at fractions of the nominal maximum rate, or add non--month-aligned dates. In these cases it may be necessary to convert to a finer granularity of time, such as weeks of FTE. To make this conversion we use a ratio of 12 months to 52 weeks, no matter which months were originally scheduled.</p><div class="odoc-spec"><div class="spec type anchored" id="type-allocation"><a href="#type-allocation" class="anchor"></a><code><span><span class="keyword">type</span> allocation</span><span> = <span><a href="FTE/index.html#type-hour">FTE.hour</a> <a href="DateMap/index.html#type-t">DateMap.t</a></span></span></code></div><div class="spec-doc"><p>An <code>allocation</code> is conceptually a map from days to rates, representing the total time that a person is allocated to a project on a given day.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-make_allocation"><a href="#val-make_allocation" class="anchor"></a><code><span><span class="keyword">val</span> make_allocation : 
  <span>with_weekends:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">CalendarLib</span>.Date.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">CalendarLib</span>.Date.t <span class="arrow">&#45;&gt;</span></span>
  <span><a href="FTE/index.html#type-hour">FTE.hour</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="FTE/index.html#type-hour">FTE.hour</a> <a href="DateMap/index.html#type-t">DateMap.t</a></span></span></code></div><div class="spec-doc"><p>Turn details from a Forecast assignment into an allocation.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-combine_allocations"><a href="#val-combine_allocations" class="anchor"></a><code><span><span class="keyword">val</span> combine_allocations : 
  <span><span><a href="FTE/index.html#type-hour">FTE.hour</a> <a href="DateMap/index.html#type-t">DateMap.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="FTE/index.html#type-hour">FTE.hour</a> <a href="DateMap/index.html#type-t">DateMap.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="FTE/index.html#type-hour">FTE.hour</a> <a href="DateMap/index.html#type-t">DateMap.t</a></span></span></code></div><div class="spec-doc"><p>Merge two allocations. This function is commutative.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_first_day"><a href="#val-get_first_day" class="anchor"></a><code><span><span class="keyword">val</span> get_first_day : <span><span><span class="type-var">'a</span> <a href="DateMap/index.html#type-t">DateMap.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">CalendarLib</span>.Date.t</span></code></div><div class="spec-doc"><p>Get the day an allocation begins.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_last_day"><a href="#val-get_last_day" class="anchor"></a><code><span><span class="keyword">val</span> get_last_day : <span><span><span class="type-var">'a</span> <a href="DateMap/index.html#type-t">DateMap.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">CalendarLib</span>.Date.t</span></code></div><div class="spec-doc"><p>Get the day an allocation ends.</p></div></div><h2 id="entities-relevant-to-scheduling-and-planning"><a href="#entities-relevant-to-scheduling-and-planning" class="anchor"></a>Entities relevant to scheduling and planning</h2><div class="odoc-spec"><div class="spec type anchored" id="type-project_plan"><a href="#type-project_plan" class="anchor"></a><code><span><span class="keyword">type</span> project_plan</span><span> = </span><span>{</span></code><ol><li id="type-project_plan.budget" class="def record field anchored"><a href="#type-project_plan.budget" class="anchor"></a><code><span>budget : <a href="FTE/index.html#type-t">FTE.t</a>;</span></code></li><li id="type-project_plan.finance_codes" class="def record field anchored"><a href="#type-project_plan.finance_codes" class="anchor"></a><code><span>finance_codes : <span>string list</span>;</span></code></li><li id="type-project_plan.latest_start_date" class="def record field anchored"><a href="#type-project_plan.latest_start_date" class="anchor"></a><code><span>latest_start_date : <span class="xref-unresolved">CalendarLib</span>.Date.t;</span></code></li><li id="type-project_plan.earliest_start_date" class="def record field anchored"><a href="#type-project_plan.earliest_start_date" class="anchor"></a><code><span>earliest_start_date : <span><span class="xref-unresolved">CalendarLib</span>.Date.t option</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>earliest_start_date = None</code> means &quot;can start as soon as you like&quot;</p><span class="comment-delim">*)</span></div></li><li id="type-project_plan.latest_end_date" class="def record field anchored"><a href="#type-project_plan.latest_end_date" class="anchor"></a><code><span>latest_end_date : <span><span class="xref-unresolved">CalendarLib</span>.Date.t option</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p><code>latest_end_date = None</code> means &quot;can end whenever you like&quot;</p><span class="comment-delim">*)</span></div></li><li id="type-project_plan.nominal_fte_percent" class="def record field anchored"><a href="#type-project_plan.nominal_fte_percent" class="anchor"></a><code><span>nominal_fte_percent : float;</span></code></li><li id="type-project_plan.max_fte_percent" class="def record field anchored"><a href="#type-project_plan.max_fte_percent" class="anchor"></a><code><span>max_fte_percent : float;</span></code></li><li id="type-project_plan.min_fte_percent" class="def record field anchored"><a href="#type-project_plan.min_fte_percent" class="anchor"></a><code><span>min_fte_percent : float;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>A <code>plan</code> gives the constraints on the possible allocations to a project.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-State"><a href="#module-State" class="anchor"></a><code><span><span class="keyword">module</span> <a href="State/index.html">State</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>The project status on the Project Tracker, shown by the column the project issue is in.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-project"><a href="#type-project" class="anchor"></a><code><span><span class="keyword">type</span> project</span><span> = </span><span>{</span></code><ol><li id="type-project.number" class="def record field anchored"><a href="#type-project.number" class="anchor"></a><code><span>number : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The issue number from GitHub</p><span class="comment-delim">*)</span></div></li><li id="type-project.name" class="def record field anchored"><a href="#type-project.name" class="anchor"></a><code><span>name : string;</span></code></li><li id="type-project.state" class="def record field anchored"><a href="#type-project.state" class="anchor"></a><code><span>state : <a href="State/index.html#type-t">State.t</a>;</span></code></li><li id="type-project.programme" class="def record field anchored"><a href="#type-project.programme" class="anchor"></a><code><span>programme : <span>string option</span>;</span></code></li><li id="type-project.plan" class="def record field anchored"><a href="#type-project.plan" class="anchor"></a><code><span>plan : <a href="#type-project_plan">project_plan</a>;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>A project, combining both a Github issue and a matching Forecast project.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-state_of_column"><a href="#val-state_of_column" class="anchor"></a><code><span><span class="keyword">val</span> state_of_column : <span>string <span class="arrow">&#45;&gt;</span></span> <a href="State/index.html#type-t">State.t</a></span></code></div><div class="spec-doc"><p>Convert the column name in GitHub to a variant type. May raise UnknownColumn</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-person"><a href="#type-person" class="anchor"></a><code><span><span class="keyword">type</span> person</span><span> = </span><span>{</span></code><ol><li id="type-person.email" class="def record field anchored"><a href="#type-person.email" class="anchor"></a><code><span>email : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Email is the primary key for persons</p><span class="comment-delim">*)</span></div></li><li id="type-person.full_name" class="def record field anchored"><a href="#type-person.full_name" class="anchor"></a><code><span>full_name : string;</span></code></li><li id="type-person.github_handle" class="def record field anchored"><a href="#type-person.github_handle" class="anchor"></a><code><span>github_handle : <span>string option</span>;</span></code></li><li id="type-person.slack_handle" class="def record field anchored"><a href="#type-person.slack_handle" class="anchor"></a><code><span>slack_handle : <span>string option</span>;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>A person</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-placeholder"><a href="#type-placeholder" class="anchor"></a><code><span><span class="keyword">type</span> placeholder</span><span> = </span><span>{</span></code><ol><li id="type-placeholder.name" class="def record field anchored"><a href="#type-placeholder.name" class="anchor"></a><code><span>name : string;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>A placeholder on Forecast.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-entity"><a href="#type-entity" class="anchor"></a><code><span><span class="keyword">type</span> entity</span><span> = </span></code><ol><li id="type-entity.Person" class="def variant constructor anchored"><a href="#type-entity.Person" class="anchor"></a><code><span>| </span><span><span class="constructor">Person</span> <span class="keyword">of</span> <a href="#type-person">person</a></span></code></li><li id="type-entity.Placeholder" class="def variant constructor anchored"><a href="#type-entity.Placeholder" class="anchor"></a><code><span>| </span><span><span class="constructor">Placeholder</span> <span class="keyword">of</span> <a href="#type-placeholder">placeholder</a></span></code></li></ol></div><div class="spec-doc"><p>An entity is a person or a placeholder.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_entity_name"><a href="#val-get_entity_name" class="anchor"></a><code><span><span class="keyword">val</span> get_entity_name : <span><a href="#type-entity">entity</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Get the name of an entity.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-assignment"><a href="#type-assignment" class="anchor"></a><code><span><span class="keyword">type</span> assignment</span><span> = </span><span>{</span></code><ol><li id="type-assignment.project" class="def record field anchored"><a href="#type-assignment.project" class="anchor"></a><code><span>project : <a href="#type-project">project</a>;</span></code></li><li id="type-assignment.entity" class="def record field anchored"><a href="#type-assignment.entity" class="anchor"></a><code><span>entity : <a href="#type-entity">entity</a>;</span></code></li><li id="type-assignment.allocation" class="def record field anchored"><a href="#type-assignment.allocation" class="anchor"></a><code><span>allocation : <a href="#type-allocation">allocation</a>;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>An assignment of an entity to a project for a specific allocation</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_person_assignment"><a href="#val-is_person_assignment" class="anchor"></a><code><span><span class="keyword">val</span> is_person_assignment : <span><a href="#type-assignment">assignment</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Check whether an assignment is to a person.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-ftes_of_assignment"><a href="#val-ftes_of_assignment" class="anchor"></a><code><span><span class="keyword">val</span> ftes_of_assignment : <span><a href="#type-assignment">assignment</a> <span class="arrow">&#45;&gt;</span></span> <a href="FTE/index.html#type-t">FTE.t</a></span></code></div><div class="spec-doc"><p>Calculate the number of FTE-weeks in a given assignment. Note that one assignment may include more than one allocation on Forecast as they have been merged.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-schedule"><a href="#type-schedule" class="anchor"></a><code><span><span class="keyword">type</span> schedule</span><span> = </span><span>{</span></code><ol><li id="type-schedule.projects" class="def record field anchored"><a href="#type-schedule.projects" class="anchor"></a><code><span>projects : <span><a href="#type-project">project</a> <a href="IntMap/index.html#type-t">IntMap.t</a></span>;</span></code></li><li id="type-schedule.people" class="def record field anchored"><a href="#type-schedule.people" class="anchor"></a><code><span>people : <span><a href="#type-person">person</a> <a href="StringMap/index.html#type-t">StringMap.t</a></span>;</span></code></li><li id="type-schedule.assignments" class="def record field anchored"><a href="#type-schedule.assignments" class="anchor"></a><code><span>assignments : <span><a href="#type-assignment">assignment</a> list</span>;</span></code></li></ol><code><span>}</span></code></div></div></div></body></html>