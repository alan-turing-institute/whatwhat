<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Log (whatwhat.Whatwhat.Log)</title><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.2.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">whatwhat</a> &#x00BB; <a href="../index.html">Whatwhat</a> &#x00BB; Log</nav><header class="odoc-preamble"><h1>Module <code><span>Whatwhat.Log</span></code></h1><p>Maintains a log of problems found with each project.</p></header><nav class="odoc-toc"><ul><li><a href="#logged-events">Logged events</a></li></ul></nav><div class="odoc-content"><h2 id="logged-events"><a href="#logged-events" class="anchor"></a>Logged events</h2><p>Each event consists of:</p><ul><li>A <i>level</i>: a unique error code which decides how serious an event is</li><li>An <i>entity</i>: an associated datatype that the event is associated with</li><li>A <i>message</i>: A string to show.</li></ul><p>TODO: Decide if this setup is really sufficient. For example, do we need to provide more information so that things can be logged / notified properly.</p><div class="odoc-spec"><div class="spec type anchored" id="type-level"><a href="#type-level" class="anchor"></a><code><span><span class="keyword">type</span> level</span><span> = </span></code><ol><li id="type-level.Error'" class="def variant constructor anchored"><a href="#type-level.Error'" class="anchor"></a><code><span>| </span><span><span class="constructor">Error'</span> <span class="keyword">of</span> int</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Prevents processing of some data</p><span class="comment-delim">*)</span></div></li><li id="type-level.Warning" class="def variant constructor anchored"><a href="#type-level.Warning" class="anchor"></a><code><span>| </span><span><span class="constructor">Warning</span> <span class="keyword">of</span> int</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Likely to cause an error if not fixed</p><span class="comment-delim">*)</span></div></li><li id="type-level.Info" class="def variant constructor anchored"><a href="#type-level.Info" class="anchor"></a><code><span>| </span><span><span class="constructor">Info</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Information for end users</p><span class="comment-delim">*)</span></div></li><li id="type-level.Debug" class="def variant constructor anchored"><a href="#type-level.Debug" class="anchor"></a><code><span>| </span><span><span class="constructor">Debug</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Information for whatwhat developers</p><span class="comment-delim">*)</span></div></li></ol></div><div class="spec-doc"><p>Severity of logged problem</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-show_level"><a href="#val-show_level" class="anchor"></a><code><span><span class="keyword">val</span> show_level : <span><a href="#type-level">level</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-entity"><a href="#type-entity" class="anchor"></a><code><span><span class="keyword">type</span> entity</span><span> = </span></code><ol><li id="type-entity.RawForecastProject" class="def variant constructor anchored"><a href="#type-entity.RawForecastProject" class="anchor"></a><code><span>| </span><span><span class="constructor">RawForecastProject</span> <span class="keyword">of</span> <span><span>(string, int)</span> <span class="xref-unresolved">Stdlib</span>.Either.t</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Project name, or issue number if it could be found.</p><span class="comment-delim">*)</span></div></li><li id="type-entity.ForecastProject" class="def variant constructor anchored"><a href="#type-entity.ForecastProject" class="anchor"></a><code><span>| </span><span><span class="constructor">ForecastProject</span> <span class="keyword">of</span> int</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The project number</p><span class="comment-delim">*)</span></div></li><li id="type-entity.Project" class="def variant constructor anchored"><a href="#type-entity.Project" class="anchor"></a><code><span>| </span><span><span class="constructor">Project</span> <span class="keyword">of</span> int</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The project number</p><span class="comment-delim">*)</span></div></li><li id="type-entity.RawForecastPlaceholder" class="def variant constructor anchored"><a href="#type-entity.RawForecastPlaceholder" class="anchor"></a><code><span>| </span><span><span class="constructor">RawForecastPlaceholder</span> <span class="keyword">of</span> string</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Placeholder's name</p><span class="comment-delim">*)</span></div></li><li id="type-entity.RawForecastPerson" class="def variant constructor anchored"><a href="#type-entity.RawForecastPerson" class="anchor"></a><code><span>| </span><span><span class="constructor">RawForecastPerson</span> <span class="keyword">of</span> string</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Person's name</p><span class="comment-delim">*)</span></div></li><li id="type-entity.ForecastPerson" class="def variant constructor anchored"><a href="#type-entity.ForecastPerson" class="anchor"></a><code><span>| </span><span><span class="constructor">ForecastPerson</span> <span class="keyword">of</span> string</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Email address</p><span class="comment-delim">*)</span></div></li><li id="type-entity.Person" class="def variant constructor anchored"><a href="#type-entity.Person" class="anchor"></a><code><span>| </span><span><span class="constructor">Person</span> <span class="keyword">of</span> string</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>email address</p><span class="comment-delim">*)</span></div></li><li id="type-entity.RawForecastAssignment" class="def variant constructor anchored"><a href="#type-entity.RawForecastAssignment" class="anchor"></a><code><span>| </span><span><span class="constructor">RawForecastAssignment</span> <span class="keyword">of</span> int</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Assignment ID in Forecast</p><span class="comment-delim">*)</span></div></li><li id="type-entity.Assignment" class="def variant constructor anchored"><a href="#type-entity.Assignment" class="anchor"></a><code><span>| </span><span><span class="constructor">Assignment</span> <span class="keyword">of</span> int * string</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Pair of a Project and a person</p><span class="comment-delim">*)</span></div></li><li id="type-entity.Other" class="def variant constructor anchored"><a href="#type-entity.Other" class="anchor"></a><code><span>| </span><span><span class="constructor">Other</span></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-event"><a href="#type-event" class="anchor"></a><code><span><span class="keyword">type</span> event</span><span> = </span><span>{</span></code><ol><li id="type-event.level" class="def record field anchored"><a href="#type-event.level" class="anchor"></a><code><span>level : <a href="#type-level">level</a>;</span></code></li><li id="type-event.entity" class="def record field anchored"><a href="#type-event.entity" class="anchor"></a><code><span>entity : <a href="#type-entity">entity</a>;</span></code></li><li id="type-event.message" class="def record field anchored"><a href="#type-event.message" class="anchor"></a><code><span>message : string;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-log'"><a href="#val-log'" class="anchor"></a><code><span><span class="keyword">val</span> log' : <span><a href="#type-event">event</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_the_log"><a href="#val-get_the_log" class="anchor"></a><code><span><span class="keyword">val</span> get_the_log : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-event">event</a> <span class="xref-unresolved">Stdlib</span>.Seq.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-isError"><a href="#val-isError" class="anchor"></a><code><span><span class="keyword">val</span> isError : <span><a href="#type-event">event</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-isWarning"><a href="#val-isWarning" class="anchor"></a><code><span><span class="keyword">val</span> isWarning : <span><a href="#type-event">event</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-isInfo"><a href="#val-isInfo" class="anchor"></a><code><span><span class="keyword">val</span> isInfo : <span><a href="#type-event">event</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-isDebug"><a href="#val-isDebug" class="anchor"></a><code><span><span class="keyword">val</span> isDebug : <span><a href="#type-event">event</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-code_spec"><a href="#type-code_spec" class="anchor"></a><code><span><span class="keyword">type</span> code_spec</span><span> = </span></code><ol><li id="type-code_spec.Without" class="def variant constructor anchored"><a href="#type-code_spec.Without" class="anchor"></a><code><span>| </span><span><span class="constructor">Without</span> <span class="keyword">of</span> <span><a href="#type-level">level</a> list</span></span></code></li><li id="type-code_spec.Only" class="def variant constructor anchored"><a href="#type-code_spec.Only" class="anchor"></a><code><span>| </span><span><span class="constructor">Only</span> <span class="keyword">of</span> <span><a href="#type-level">level</a> list</span></span></code></li><li id="type-code_spec.All" class="def variant constructor anchored"><a href="#type-code_spec.All" class="anchor"></a><code><span>| </span><span><span class="constructor">All</span></span></code></li></ol></div><div class="spec-doc"><p>A type which determines whether specific error codes are to be suppressed or filtered for.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-gather_events"><a href="#val-gather_events" class="anchor"></a><code><span><span class="keyword">val</span> gather_events : 
  <span>verbose:int <span class="arrow">&#45;&gt;</span></span>
  <span>restrict_codes:<a href="#type-code_spec">code_spec</a> <span class="arrow">&#45;&gt;</span></span>
  <span>restrict_issues:<span><span>int list</span> option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span>int option</span> * <a href="#type-event">event</a>)</span> list</span></span></code></div><div class="spec-doc"><p>Returns a list of events taken from the log, paired with the corresponding GitHub issue number if one could be found. The <code>verbose</code>, <code>restrict_codes</code>, and <code>restrict_issues</code> are used to decide which events are included in the output.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-gather_events'"><a href="#val-gather_events'" class="anchor"></a><code><span><span class="keyword">val</span> gather_events' : 
  <span>verbose:int <span class="arrow">&#45;&gt;</span></span>
  <span>restrict_codes:<a href="#type-code_spec">code_spec</a> <span class="arrow">&#45;&gt;</span></span>
  <span>restrict_issues:<span><span>int list</span> option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span>int option</span> * <span><a href="#type-event">event</a> list</span>)</span> list</span></span></code></div><div class="spec-doc"><p>The same as above, but events with the same issue number (or lack thereof) are gathered into a single list. This lets you iterate over issue numbers instead of events.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pretty_print"><a href="#val-pretty_print" class="anchor"></a><code><span><span class="keyword">val</span> pretty_print : 
  <span>use_color:bool <span class="arrow">&#45;&gt;</span></span>
  <span>verbose:int <span class="arrow">&#45;&gt;</span></span>
  <span>restrict_codes:<a href="#type-code_spec">code_spec</a> <span class="arrow">&#45;&gt;</span></span>
  <span>restrict_issues:<span><span>int list</span> option</span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p>Pretty-print all events in the log to standard output.</p></div></div></div></body></html>