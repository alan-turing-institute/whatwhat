<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Utils (whatwhat.Whatwhat.Utils)</title><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.2.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">whatwhat</a> &#x00BB; <a href="../index.html">Whatwhat</a> &#x00BB; Utils</nav><header class="odoc-preamble"><h1>Module <code><span>Whatwhat.Utils</span></code></h1><p>Utility module.</p></header><nav class="odoc-toc"><ul><li><a href="#shims-for-the-standard-library">Shims for the standard library</a></li><li><a href="#http-exceptions">HTTP exceptions</a></li><li><a href="#dates">Dates</a></li><li><a href="#other-stuff">Other stuff</a></li></ul></nav><div class="odoc-content"><h2 id="shims-for-the-standard-library"><a href="#shims-for-the-standard-library" class="anchor"></a>Shims for the standard library</h2><p>Many of the functions in this module are simple functions which should arguably be in the OCaml standard library, but aren't, because the standard library is so barebones.</p><div class="odoc-spec"><div class="spec value anchored" id="val-is_digit"><a href="#val-is_digit" class="anchor"></a><code><span><span class="keyword">val</span> is_digit : <span>char <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Check whether a character is <code>0-9</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-range"><a href="#val-range" class="anchor"></a><code><span><span class="keyword">val</span> range : <span>int <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>int list</span></span></code></div><div class="spec-doc"><p>Generate a range from i to j-1 inclusive.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-group_by"><a href="#val-group_by" class="anchor"></a><code><span><span class="keyword">val</span> group_by : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> bool)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> list</span> list</span></span></code></div><div class="spec-doc"><p>Group adjacent elements of a list together using a predicate.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sort_and_group_by"><a href="#val-sort_and_group_by" class="anchor"></a><code><span><span class="keyword">val</span> sort_and_group_by : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'key</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'key</span> * <span><span class="type-var">'a</span> list</span>)</span> list</span></span></code></div><div class="spec-doc"><p>Sort and then group elements of a list according to a key.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-take"><a href="#val-take" class="anchor"></a><code><span><span class="keyword">val</span> take : <span>int <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> list</span></span></code></div><div class="spec-doc"><p>Take the first n elements of a list.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-drop"><a href="#val-drop" class="anchor"></a><code><span><span class="keyword">val</span> drop : <span>int <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> list</span></span></code></div><div class="spec-doc"><p>Drop the first n elements of a list.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-split_at"><a href="#val-split_at" class="anchor"></a><code><span><span class="keyword">val</span> split_at : <span>int <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> list</span> * <span><span class="type-var">'a</span> list</span></span></code></div><div class="spec-doc"><p><code>split_at n xs</code> returns <code>(take n xs, drop n xs)</code> (i.e. the first <code>n</code> elements and the rest).</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sum"><a href="#val-sum" class="anchor"></a><code><span><span class="keyword">val</span> sum : <span><span>float list</span> <span class="arrow">&#45;&gt;</span></span> float</span></code></div><div class="spec-doc"><p>Sum a list of floats.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-max_by"><a href="#val-max_by" class="anchor"></a><code><span><span class="keyword">val</span> max_by : <span>default:<span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> list</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span></span></code></div><div class="spec-doc"><p>Get the maximum of a list using a key function.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-transpose"><a href="#val-transpose" class="anchor"></a><code><span><span class="keyword">val</span> transpose : <span><span><span><span class="type-var">'a</span> list</span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> list</span> list</span></span></code></div><div class="spec-doc"><p>Transpose a list of lists.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-contains"><a href="#val-contains" class="anchor"></a><code><span><span class="keyword">val</span> contains : <span>?case_sensitive:bool <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Check if the second argument is a substring of the first.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-read_file"><a href="#val-read_file" class="anchor"></a><code><span><span class="keyword">val</span> read_file : <span>string <span class="arrow">&#45;&gt;</span></span> <span>string option</span></span></code></div><div class="spec-doc"><p>Attempt to read all text from a file. Returns <code>None</code> for various errors (e.g. if the file doesn't exist).</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-show_opt"><a href="#val-show_opt" class="anchor"></a><code><span><span class="keyword">val</span> show_opt : <span><span>string option</span> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Print a string option.</p></div></div><h2 id="http-exceptions"><a href="#http-exceptions" class="anchor"></a>HTTP exceptions</h2><div class="odoc-spec"><div class="spec exception anchored" id="exception-HttpError"><a href="#exception-HttpError" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">HttpError</span> <span class="keyword">of</span> string</span></code></div><div class="spec-doc"><p>Generic HTTP error.</p></div></div><div class="odoc-spec"><div class="spec exception anchored" id="exception-GithubRateLimitError"><a href="#exception-GithubRateLimitError" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">GithubRateLimitError</span> <span class="keyword">of</span> string</span></code></div><div class="spec-doc"><p>Raised when the GitHub API rate limit is exceeded.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-check_http_response"><a href="#val-check_http_response" class="anchor"></a><code><span><span class="keyword">val</span> check_http_response : <span><span class="xref-unresolved">Cohttp</span>.Response.t <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Inspect a response and raise a <code>HTTPError</code> if the code is not a 200, or a <code>GithubRateLimitError</code> if the GitHub API rate limit is exceeded.</p></div></div><h2 id="dates"><a href="#dates" class="anchor"></a>Dates</h2><div class="odoc-spec"><div class="spec type anchored" id="type-date"><a href="#type-date" class="anchor"></a><code><span><span class="keyword">type</span> date</span><span> = <span class="xref-unresolved">CalendarLib</span>.Date.t</span></code></div><div class="spec-doc"><p>We redefine the standard <code>Date.t</code> type here so that we can derive Show instances for record types containing it.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_date"><a href="#val-pp_date" class="anchor"></a><code><span><span class="keyword">val</span> pp_date : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">CalendarLib</span>.Printer.Date.t <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-show_date"><a href="#val-show_date" class="anchor"></a><code><span><span class="keyword">val</span> show_date : <span><span class="xref-unresolved">CalendarLib</span>.Printer.Date.t <span class="arrow">&#45;&gt;</span></span> string</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-date_of_string"><a href="#val-date_of_string" class="anchor"></a><code><span><span class="keyword">val</span> date_of_string : 
  <span>?lax:bool <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="xref-unresolved">CalendarLib</span>.Date.t, <span>[&gt; <span>`Msg of string</span> ]</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p>Parse a string as a date in the format YYYY-MM-DD. If the string is not in this format, return <code>Error (`Msg s)</code> (where <code>s</code> is some error message), else <code>Ok date</code>.</p><p>If <code>lax</code> is set to <code>true</code>, then punctuation is ignored, so e.g. YYYYMMDD and YYYY/MM/DD will also parse correctly. <code>lax</code> is false by default.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_start_date"><a href="#val-default_start_date" class="anchor"></a><code><span><span class="keyword">val</span> default_start_date : 
  <span>?relative_to:<span class="xref-unresolved">CalendarLib</span>.Date.t <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">CalendarLib</span>.Date.t</span></code></div><div class="spec-doc"><p>Calculate the default start date for Forecast export, which is the 1st of the previous month (relative to today's date). The <code>relative_to</code> argument can be specified to allow for unit testing.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_end_date"><a href="#val-default_end_date" class="anchor"></a><code><span><span class="keyword">val</span> default_end_date : 
  <span>?relative_to:<span class="xref-unresolved">CalendarLib</span>.Date.t <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">CalendarLib</span>.Date.field <span class="xref-unresolved">CalendarLib</span>.Date.date</span></span></code></div><div class="spec-doc"><p>Calculate the default end date for Forecast export, which is the last day of the next month (relative to today's date). The <code>relative_to</code> argument can be specified to allow for unit testing.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-rollback_week"><a href="#val-rollback_week" class="anchor"></a><code><span><span class="keyword">val</span> rollback_week : <span><span class="xref-unresolved">CalendarLib</span>.Date.t <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">CalendarLib</span>.Date.t</span></code></div><div class="spec-doc"><p>Roll a date back to a Monday. Leaves Mondays untouched.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-rollforward_week"><a href="#val-rollforward_week" class="anchor"></a><code><span><span class="keyword">val</span> rollforward_week : 
  <span>?with_weekend:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">CalendarLib</span>.Date.t <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">CalendarLib</span>.Date.t</span></code></div><div class="spec-doc"><p>Roll a date forward to a Friday. Leaves Fridays untouched. If <code>with_weekend</code> is <code>true</code>, then rolls forward to Sundays.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_xdays_between"><a href="#val-get_xdays_between" class="anchor"></a><code><span><span class="keyword">val</span> get_xdays_between : 
  <span>day:<span class="xref-unresolved">CalendarLib</span>.Date.day <span class="arrow">&#45;&gt;</span></span>
  <span>start_date:<span class="xref-unresolved">CalendarLib</span>.Date.t <span class="arrow">&#45;&gt;</span></span>
  <span>end_date:<span class="xref-unresolved">CalendarLib</span>.Date.t <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">CalendarLib</span>.Date.t list</span></span></code></div><div class="spec-doc"><p>Get all days between the start and end dates, inclusive, which are the day specified in <code>day</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_turing_weeks_in_month"><a href="#val-get_turing_weeks_in_month" class="anchor"></a><code><span><span class="keyword">val</span> get_turing_weeks_in_month : 
  <span><span><span>[&gt; `Year <span>| `Month</span> ]</span> <span class="xref-unresolved">CalendarLib</span>.Date.date</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">CalendarLib</span>.Date.t list</span></span></code></div><div class="spec-doc"><p>Get all Mondays of the weeks where the Thursday belongs to a calendar month. The day of the month of the input argument does not matter.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_weekdays_in_week"><a href="#val-get_weekdays_in_week" class="anchor"></a><code><span><span class="keyword">val</span> get_weekdays_in_week : <span><span class="xref-unresolved">CalendarLib</span>.Date.t <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">CalendarLib</span>.Date.t list</span></span></code></div><div class="spec-doc"><p>Get a list of the weekdays in a week. Input argument can be any day of the week in question.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-show_month"><a href="#val-show_month" class="anchor"></a><code><span><span class="keyword">val</span> show_month : <span>int <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Maps ints from 1-12 to month names Jan-Dec.</p></div></div><h2 id="other-stuff"><a href="#other-stuff" class="anchor"></a>Other stuff</h2><div class="odoc-spec"><div class="spec value anchored" id="val-all_throttled"><a href="#val-all_throttled" class="anchor"></a><code><span><span class="keyword">val</span> all_throttled : <span>?max_concurrent:int <span class="arrow">&#45;&gt;</span></span> <span><span><span><span class="type-var">'a</span> <span class="xref-unresolved">Lwt</span>.t</span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> list</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>all_throttled</code> is like <code>Lwt.all</code> but only resolves <code>max_concurrent</code> promises at a time. Defaults to 150 (which, as determined by trial and error, is approximately how many requests GitHub likes taking at a go).</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-gfm_escape"><a href="#val-gfm_escape" class="anchor"></a><code><span><span class="keyword">val</span> gfm_escape : <span>string <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Escape a string such that characters show up correctly in (GitHub-Flavoured) Markdown. Note: this means that formatting etc. will be lost in the resulting post, and it'll purely appear as a string.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-dequote"><a href="#val-dequote" class="anchor"></a><code><span><span class="keyword">val</span> dequote : <span>string <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Remove double quotes around a string (if present.</p></div></div></div></body></html>